<!DOCTYPE html>
<html lang="fa">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>فرم تماس با ما</title>

    <meta name="description" content="فرم تماس با ما بازرگانی کاسپین" />
    <link rel="stylesheet" href="[##cms.cms.cdn##]/css/outputDesk.css" />
    <style>
      input::placeholder,
      textarea::placeholder {
        color: black !important;
        font-size: 14px !important;
        font-family: "IRANSansWeb500" !important;
    }
    .formPage input,
    .formPage textarea {
        color: black !important;
        font-family: "IRANSansWeb500" !important;
        font-size: 14px !important;
      }
      .afterStar [data-bc-schema-info-part="1"] [data-bc-part-related-cell] {
        position: relative;
      }
      .afterStar
        [data-bc-schema-info-part="1"]
        [data-bc-part-related-cell]::after {
        content: "*";
        color: #0088d0;
        position: absolute;
        top: 9px;
      }
      .afterStar:nth-child(1)
        [data-bc-schema-info-part="1"]
        [data-bc-part-related-cell]::after {
        right: 33px;
      }
      .afterStar:nth-child(2)
        [data-bc-schema-info-part="1"]
        [data-bc-part-related-cell]::after {
        right: 89px;
      }
      .afterStar:nth-child(3)
        [data-bc-schema-info-part="1"]
        [data-bc-part-related-cell]::after {
        right: 78px;
      }
      .afterStar:nth-child(4)
        [data-bc-schema-info-part="1"]
        [data-bc-part-related-cell]::after {
        right: 49px;
      }
      .afterStar:nth-child(5)
        [data-bc-schema-info-part="1"]
        [data-bc-part-related-cell]::after {
        right: 103px;
        top: 13px;
      }
    </style>
  </head>

  <body>
    <div
      class="formPage min-h-svh bg-nWhite flex flex-col justify-between"
      dir="rtl"
    >
      <basis core="call" file="header.inc" />
      <div class="inner">
        <div
          class="title pt-[160px] w-80p mx-auto mb-16 max-w-[1040px] pb-4 border-b border-b-txtblack"
        >
          <h1 class="font-IRANSansWeb500 text-base text-txtblack">
            فرم تماس با ما
          </h1>
        </div>
        <div class="formContainer max-w-[1066px] w-85p mx-auto">
          <form
            name="myForm"
            class="homeForm1"
            action=""
            onsubmit="return validateForm()"
            method="post"
          >
            <basis
              core="schema"
              run="atclient"
              schemaUrl="/schema/domainform/4EE29C18-DCB6-4B38-8660-6A3133312159/D289FD91-2C12-4A16-8E4E-E7AE5CABC45C/fa/فرم-تماس-با-ما"
              displayMode="new"
              button="[data-btn-add1]"
              resultSourceId="demo.data1"
              onRendered="renderFn1"
            >
            </basis>
            <basis
              core="callback"
              run="AtClient"
              triggers="demo.data1"
              method="onSource1"
            ></basis>
            <basis
              core="api"
              url="/schema/domainform/4EE29C18-DCB6-4B38-8660-6A3133312159/fa/editobject"
              method="post"
              run="atclient"
              body="object_edit={##edit.object1.value##}&captcha={##edit.object1.captcha##}&captchaid={##edit.object1.captchaid##}"
              content-type="application/x-www-form-urlencoded"
              triggers="edit.object1"
              if="{##edit.object1##}"
              OnProcessed="OnProcessedEditObject1"
            >
            </basis>
            <div data-bc-question="" class="qclass8 w-fit">
              <div class="responsMsg1 responsMsg">
                <span>فرم با موفقیت ثبت شد.</span>
              </div>
              <div
                id="requestBox"
                class="captchaContainerclass captcha-sefaresh2"
                style="margin-bottom: 20px"
                data-bc-answer-container=""
                data-bc-schema-info-multi="0"
                data-bc-schema-info-word="58"
                data-bc-schema-info-part="1"
                data-bc-schema-info-part-0-type="text"
              >
                <basis
                  core="dbsource"
                  source="trust_login"
                  name="captcha1"
                  triggers="cms.reload1"
                  run="atclient"
                >
                  <member name="code1" type="scalar" request="captcha"></member>
                </basis>
                <basis
                  datamembername="captcha1.code1"
                  core="print"
                  run="atclient"
                >
                  <face>
                    <script type="text/template">

                          <span class="captcha-sefaresh">
                              <img src="/@captcha@" width="88" height="44" class="captcha-sefaresh"
                                  alt="captcha" title="captcha" />
                              <input type="hidden" name="captchaid" value="@captcha@" />
                          </span>
                      <img src="[##cms.cms.cdn##]/images/reload-captcha.png" class="refressh cursor-pointer refressh1" run="atclient" bc-triggers="click" bc-name="cms.reload1" />
                      <input type="text" class="codeinputm" name="captcha"
                          />
                    </script>
                  </face>
                </basis>
              </div>
              <button
                class="flex bg-txtblack py-2 bg-main w-full rounded-[20px] justify-center items-center"
                type="submit"
                data-btn-add1
                data-btn-submit=""
              >
                <span class="font-IRANSansWeb400 text-sm text-nWhite">
                  ثبت</span
                >
              </button>
            </div>
          </form>
        </div>
      </div>

      <basis core="call" file="footer.inc" />
    </div>
    <script src="[##cms.cms.cdn##]/_js/basiscore-2.30.1.min.js"></script>
    <basis core="call" file="script.inc" />

    <script>
      const host = {
        debug: !1,
        settings: {
          "connection.web.trust_login": "https://basispanel.ir/apicms",
          "connection.web.basiscore": "https://basispanel.ir/apicms",
          "connection.web.media": "https://basispanel.ir/apicms",
          "default.dbsource.verb": "post",
          "default.call.verb": "get",
          "default.viewCommand.groupColumn": "prpid",
          "default.dmnid": "4883",
          "default.binding.regex": "\\{##([^#]*)##\\}",
        },
      };
      document.querySelector("header").classList.add("dark");

      function onSource1(args) {
        console.log("onSource");
        const captcha = document.querySelector(
          ".homeForm1 #requestBox input[name='captcha']"
        ).value;
        const captchaid = document.querySelector(
          ".homeForm1 #requestBox input[name='captchaid']"
        ).value;
        const stringJson = JSON.stringify(args.source?.rows[0]);
        console.log("stringJson", stringJson);
        $bc.setSource("edit.object1", {
          value: stringJson,
          captcha: captcha,
          captchaid: captchaid,
        });
      }

      let responsMsg = document.querySelector(".responsMsg1");
      let responsMsgIn = document.querySelector(".responsMsg1 span");

      async function OnProcessedEditObject1(args) {
        console.log("OnProcessedEditObject1");
        const response = args.response;
        const json = await response.json();

        if (json.errorid == 6) {
          console.log(json);
          responsMsgIn.innerHTML = "فرم با موفقیت ثبت شد.";
          responsMsg.style.display = "block";

          setTimeout(() => {
            responsMsg.style.display = "none";
          }, 2000);
        }
        if (json.errorid == 4) {
          console.log(json);
          responsMsgIn.innerHTML = "لطفا کپچا را به درستی وارد کنید.";

          responsMsg.style.display = "block";

          setTimeout(() => {
            responsMsg.style.display = "none";
          }, 2000);
        }
      }

      function renderFn1(params) {
       
        let questions = document.querySelectorAll(
          ".homeForm1 div[data-bc-question]"
        );
        questions.forEach((element) => {
            element.classList.add("afterStar");
            
          let title = element.querySelector(
            ".homeForm1 [data-bc-question-title]"
          );
          let qInput = element.querySelector(".homeForm1 input");
          let qTxtArea = element.querySelector(".homeForm1 _textarea");
          if (title) {
            title = element.querySelector(
              ".homeForm1 [data-bc-question-title]"
            ).innerHTML;
            if (qInput) {
              qInput.setAttribute("placeholder", title);
            } else if (qTxtArea) {
              qTxtArea.setAttribute("placeholder", title);
            }
          }
          console.log("q", qInput);
        });
    let inputs = document.querySelectorAll("input") 
    inputs.forEach(element => {
        element.addEventListener("input" , function (params) {
            if (this.value=="") {
                console.log("epmty");
                $(this).closest("div[data-bc-question]").addClass("afterStar")
                
            }
            else{
                $(this).closest("div[data-bc-question]").removeClass("afterStar")
            }

        })
    });
   


    let textAreas = document.querySelectorAll("textarea") 
    textAreas.forEach(element => {
        element.addEventListener("input" , function (params) {
            console.log( $(this).closest("div[data-bc-question]"));
            
            if (this.value=="") {
                console.log("epmty");
                $(this).closest("div[data-bc-question]").addClass("afterStar")
                
            }
            else{
                $(this).closest("div[data-bc-question]").removeClass("afterStar")
            }

        })
    });
   

}
    </script>
  </body>
</html>
